<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>ilc-sdk</title>
	<meta name="description" content="Documentation for ilc-sdk">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">ilc-sdk</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1>ilc-sdk</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#app-development-sdk-for-ilc" id="app-development-sdk-for-ilc" style="color: inherit; text-decoration: none;">
					<h1>App development SDK for ILC</h1>
				</a>
				<p><a href="https://www.npmjs.com/package/ilc-sdk"><img src="https://badgen.net/npm/v/ilc-sdk?color=red&icon=npm&label=" alt="NPM package"></a>
				<a href="https://www.npmjs.com/package/ilc-sdk"><img src="https://badgen.net/npm/dt/ilc-sdk" alt="NPM downloads"></a></p>
				<p>SDK intended for use inside Micro Frontends to conveniently communicate with Isomorphic Layout Composer.</p>
				<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
					<h2>Installation</h2>
				</a>
				<pre><code class="language-bash">$ npm i ilc-sdk</code></pre>
				<a href="#nodejs-and-app-bundles" id="nodejs-and-app-bundles" style="color: inherit; text-decoration: none;">
					<h2>Node.js and app bundles</h2>
				</a>
				<p>This package features 2 bundles that are intended to be used in Node.js app that runs SSR bundle of your app and
				the application itself.</p>
				<a href="#nodejs-bundle" id="nodejs-bundle" style="color: inherit; text-decoration: none;">
					<h3>Node.js bundle</h3>
				</a>
				<p>It works only in Node.js and is designed to parse requests from ILC and form responses. It also provides adapter for application
				bundle to work in Node.js environment.</p>
				<ul>
					<li>How to use: <code>const IlcSdk = require(&#39;ilc-sdk&#39;).default;</code></li>
					<li>Documentation: <a href="https://namecheap.github.io/ilc-sdk/classes/_server_ilcsdk_.ilcsdk.html">https://namecheap.github.io/ilc-sdk/classes/_server_ilcsdk_.ilcsdk.html</a></li>
				</ul>
				<p><strong>Vue.js example:</strong></p>
				<pre><code class="language-javascript"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);
<span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);
<span class="hljs-keyword">const</span> server = express();

<span class="hljs-keyword">const</span> {createBundleRenderer} = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;vue-server-renderer&#x27;</span>);
<span class="hljs-keyword">const</span> bundle = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./dist/vue-ssr-server-bundle.json&#x27;</span>);
<span class="hljs-keyword">const</span> clientManifest = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./dist/vue-ssr-client-manifest.json&#x27;</span>);
<span class="hljs-keyword">const</span> appAssets = {
    <span class="hljs-attr">spaBundle</span>: clientManifest.all.find(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> v.endsWith(<span class="hljs-string">&#x27;.js&#x27;</span>)),
    <span class="hljs-attr">cssBundle</span>: clientManifest.all.find(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> v.endsWith(<span class="hljs-string">&#x27;.css&#x27;</span>))
};

<span class="hljs-keyword">const</span> IlcSdk = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;ilc-sdk&#x27;</span>).default;
<span class="hljs-keyword">const</span> ilcSdk = <span class="hljs-keyword">new</span> IlcSdk({ <span class="hljs-attr">publicPath</span>: clientManifest.publicPath });

<span class="hljs-keyword">const</span> renderer = createBundleRenderer(bundle, {
    <span class="hljs-attr">template</span>: fs.readFileSync(<span class="hljs-string">&#x27;./index.template.html&#x27;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>),
    <span class="hljs-attr">clientManifest</span>: clientManifest,
    <span class="hljs-attr">runInNewContext</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">inject</span>: <span class="hljs-literal">false</span>
});

server.get(<span class="hljs-string">&#x27;/_ilc/assets-discovery&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> ilcSdk.assetsDiscoveryHandler(req, res, appAssets));

server.get(<span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    res.setHeader(<span class="hljs-string">&#x27;Content-Type&#x27;</span>, <span class="hljs-string">&#x27;text/html&#x27;</span>);

    <span class="hljs-keyword">const</span> ilcData = ilcSdk.processRequest(req);

    <span class="hljs-keyword">const</span> context = {
        ilcData,
        <span class="hljs-attr">url</span>: ilcData.getCurrentReqUrl(),
    };

    renderer.renderToString(context, <span class="hljs-function">(<span class="hljs-params">err, html</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (err) {
            <span class="hljs-comment">// ...</span>
            <span class="hljs-keyword">return</span>;
        } 

        ilcSdk.processResponse(ilcData, res, {
            <span class="hljs-attr">pageTitle</span>: context.meta.inject().title.text(),
            <span class="hljs-attr">pageMetaTags</span>: context.meta.inject().meta.text(),
            appAssets,
        });
        res.send(html);
    });

});</code></pre>
				<a href="#application-bundle" id="application-bundle" style="color: inherit; text-decoration: none;">
					<h3>Application bundle</h3>
				</a>
				<p>Provides SDK that should be used within your application bundle. It works well with server and client side rendering.</p>
				<ul>
					<li>How to use: <code>import IlcAppSdk from &#39;ilc-sdk/app&#39;;</code></li>
					<li>Documentation <a href="https://namecheap.github.io/ilc-sdk/classes/_app_index_.ilcappsdk.html">is available via this link</a>.</li>
				</ul>
				<a href="#js-docs" id="js-docs" style="color: inherit; text-decoration: none;">
					<h2>JS docs</h2>
				</a>
				<p>See <a href="https://namecheap.github.io/ilc-sdk/">https://namecheap.github.io/ilc-sdk/</a></p>
				<a href="#low-level-ilc-lt-gt-micro-frontend-interface" id="low-level-ilc-lt-gt-micro-frontend-interface" style="color: inherit; text-decoration: none;">
					<h2>Low level ILC &lt;-&gt; Micro Frontend interface</h2>
				</a>
				<p>This is the description of the server side ILC &lt;-&gt; Micro Frontend interface which is implemented by this library in a form
				of SDK.</p>
				<a href="#input-interface-ilc--gt-micro-frontend" id="input-interface-ilc--gt-micro-frontend" style="color: inherit; text-decoration: none;">
					<h3>Input interface ILC -&gt; Micro Frontend</h3>
				</a>
				<p>With every request for SSR content from the app ILC sends the following meta-information:</p>
				<ol>
					<li><p>Query parameter <code>routerProps</code></p>
						<p>Contains base64 encoded JSON object with the following keys:</p>
						<ul>
							<li><p><code>basePath</code> - Base path that is relative to the matched route.</p>
								<p>  So for <code>reqUrl = /a/b/c?d=1</code> &amp; matched route <code>/a/*</code> base path will be <code>/a/</code>.
								While for <code>reqUrl = /a/b/c?d=1</code> &amp; matched route <code>/a/b/c</code> base path will be <code>/a/b/c</code>.</p>
							</li>
							<li><p><code>reqUrl</code> - Request URL string. This contains only the URL that is present in the actual HTTP request. It <strong>DOES NOT</strong> contain information about locale.</p>
								<p>  <code>reqUrl</code> = <code>/status?name=ryan</code> if the request is:</p>
								<pre><code>GET /status?name=ryan HTTP/1.1<span class="hljs-symbol">\r</span><span class="hljs-symbol">\n</span>
Accept: text/plain<span class="hljs-symbol">\r</span><span class="hljs-symbol">\n</span>
<span class="hljs-symbol">\r</span><span class="hljs-symbol">\n</span></code></pre>
							</li>
							<li><p><em>(legacy)</em> <code>fragmentName</code> - string with name of the fragment</p>
							</li>
						</ul>
					</li>
					<li><p>Query parameter <code>appProps</code></p>
						<p>Sent only if app has some <em>Props</em> defined at the app or route slot level.
						Contains base64 encoded JSON object with defined <em>Props</em>.</p>
					</li>
					<li><p>Header <code>x-request-uri</code>. Request URL string. This contains only the URL that is present in the actual HTTP request. It <strong>may contain</strong> information about locale.</p>
					</li>
					<li><p>Optional header <code>x-request-intl</code>. Present only if ILC runs with Intl feature enabled. Format is described <a href="./src/server/IlcProtocol.ts">here</a>.</p>
					</li>
				</ol>
				<p>Both query params mentioned here can be decoded in the following manner:</p>
				<pre><code class="language-javascript"><span class="hljs-built_in">JSON</span>.parse(Buffer.from(req.query.routerProps, <span class="hljs-string">&#x27;base64&#x27;</span>).toString(<span class="hljs-string">&#x27;utf-8&#x27;</span>))</code></pre>
				<a href="#response-interface-micro-frontend--gt-ilc" id="response-interface-micro-frontend--gt-ilc" style="color: inherit; text-decoration: none;">
					<h3>Response interface Micro Frontend -&gt; ILC</h3>
				</a>
				<p>App possible response headers:</p>
				<ul>
					<li><code>Link</code> - Check <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Link">reference</a>.</li>
					<li><code>x-head-title</code> - <em>(only primary app)</em> Page title encoded with base64. Will be injected onto <code>&lt;head&gt;</code> tag.
					Ex: <code>Buffer.from(&#39;&lt;title&gt;Page title&lt;/title&gt;&#39;, &#39;utf-8&#39;).toString(&#39;base64&#39;)</code></li>
					<li><code>x-head-meta</code> - <em>(only primary app)</em> Page <a href="https://www.w3schools.com/tags/tag_meta.asp">meta tags</a> encoded with base64.
					Ex: <code>Buffer.from(&#39;&lt;meta name=&quot;description&quot; content=&quot;Free Web tutorials&quot;&gt;&lt;meta name=&quot;keywords&quot; content=&quot;HTML,CSS,XML,JavaScript&quot;&gt;&#39;, &#39;utf-8&#39;).toString(&#39;base64&#39;)</code></li>
				</ul>
				<p>HTTP status code from the primary app will be used to define HTTP status code of the requested page.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class="label tsd-is-external">
						<span>Internals</span>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_app_index_.html">&quot;app/index&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_server_index_.html">&quot;server/index&quot;</a>
					</li>
					<li class="label tsd-is-external">
						<span>Externals</span>
					</li>
					<li class=" tsd-kind-module tsd-is-external">
						<a href="modules/_app_ilcintl_.html">&quot;app/<wbr>Ilc<wbr>Intl&quot;</a>
					</li>
					<li class=" tsd-kind-module tsd-is-external">
						<a href="modules/_app_commontypes_.html">&quot;app/common<wbr>Types&quot;</a>
					</li>
					<li class=" tsd-kind-module tsd-is-external">
						<a href="modules/_app_types_.html">&quot;app/types&quot;</a>
					</li>
					<li class=" tsd-kind-module tsd-is-external">
						<a href="modules/_app_utils_.html">&quot;app/utils&quot;</a>
					</li>
					<li class=" tsd-kind-module tsd-is-external">
						<a href="modules/_server_ilcsdk_.html">&quot;server/<wbr>Ilc<wbr>Sdk&quot;</a>
					</li>
					<li class=" tsd-kind-module tsd-is-external">
						<a href="modules/_server_webpackplugins_.html">&quot;server/<wbr>Webpack<wbr>Plugins&quot;</a>
					</li>
					<li class=" tsd-kind-module tsd-is-external">
						<a href="modules/_server_types_.html">&quot;server/types&quot;</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>